<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <link rel="icon" type="image/x-icon" href="favicon_io/favicon.ico"><link rel="icon" type="image/png" sizes="32x32" href="favicon_io/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="favicon_io/favicon-16x16.png"><link rel="manifest" href="favicon_io/site.webmanifest">
    <link rel="apple-touch-icon" sizes="180x180" href="favicon_io/apple-touch-icon.png">
    <title>Admin Dashboard - Oda Pap</title>
    <link rel="stylesheet" href="admin.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <!-- Mobile Header -->
    <header class="mobile-header">
        <button class="menu-btn" id="menuBtn"><i class="fas fa-bars"></i></button>
        <h1 id="mobileTitle">Dashboard</h1>
        <div class="header-actions">
            <span class="admin-badge" id="adminBadge">Admin</span>
        </div>
    </header>

    <!-- Sidebar -->
    <aside class="sidebar" id="sidebar">
        <div class="sidebar-brand">
            <img src="images/logo.png" alt="Logo">
            <span>Oda Pap</span>
        </div>
        <nav class="nav-menu">
            <a href="#" class="nav-link active" data-section="dashboard">
                <i class="fas fa-home"></i><span>Dashboard</span>
            </a>
            <a href="#" class="nav-link" data-section="orders">
                <i class="fas fa-shopping-bag"></i><span>Orders</span>
                <span class="nav-badge" id="ordersBadge">0</span>
            </a>
            <a href="#" class="nav-link" data-section="products">
                <i class="fas fa-box"></i><span>Products</span>
            </a>
            <a href="#" class="nav-link" data-section="users">
                <i class="fas fa-users"></i><span>Users</span>
            </a>
            <a href="#" class="nav-link" data-section="analytics">
                <i class="fas fa-chart-line"></i><span>Analytics</span>
            </a>
            <a href="#" class="nav-link" data-section="transactions">
                <i class="fas fa-credit-card"></i><span>Transactions</span>
            </a>
            <a href="#" class="nav-link" data-section="verifications">
                <i class="fas fa-shield-alt"></i><span>Verifications</span>
                <span class="nav-badge" id="verifyBadge">0</span>
            </a>
            <a href="#" class="nav-link" data-section="notifications">
                <i class="fas fa-bell"></i><span>Notifications</span>
            </a>
            <a href="#" class="nav-link" data-section="settings">
                <i class="fas fa-cog"></i><span>Settings</span>
            </a>
        </nav>
        <div class="sidebar-footer">
            <button class="logout-btn" id="logoutBtn">
                <i class="fas fa-sign-out-alt"></i><span>Logout</span>
            </button>
        </div>
    </aside>
    <div class="sidebar-overlay" id="overlay"></div>

    <!-- Main Content -->
    <main class="main">
        <!-- Dashboard -->
        <section class="page active" id="dashboard-page">
            <div class="page-header">
                <h2>Dashboard Overview</h2>
                <span class="date-display" id="dateDisplay"></span>
            </div>
            
            <div class="metrics">
                <div class="metric-card clickable" onclick="switchSection('orders')">
                    <div class="metric-icon blue"><i class="fas fa-shopping-cart"></i></div>
                    <div class="metric-info">
                        <span class="metric-value" id="metricOrders">0</span>
                        <span class="metric-label">Total Orders</span>
                    </div>
                    <i class="fas fa-chevron-right metric-arrow"></i>
                </div>
                <div class="metric-card clickable" onclick="switchSection('orders')">
                    <div class="metric-icon orange"><i class="fas fa-clock"></i></div>
                    <div class="metric-info">
                        <span class="metric-value" id="metricPending">0</span>
                        <span class="metric-label">Pending</span>
                    </div>
                    <i class="fas fa-chevron-right metric-arrow"></i>
                </div>
                <div class="metric-card clickable" onclick="switchSection('transactions')">
                    <div class="metric-icon green"><i class="fas fa-money-bill-wave"></i></div>
                    <div class="metric-info">
                        <span class="metric-value" id="metricRevenue">KES 0</span>
                        <span class="metric-label">Revenue</span>
                    </div>
                    <i class="fas fa-chevron-right metric-arrow"></i>
                </div>
                <div class="metric-card clickable" onclick="switchSection('users')">
                    <div class="metric-icon purple"><i class="fas fa-users"></i></div>
                    <div class="metric-info">
                        <span class="metric-value" id="metricUsers">0</span>
                        <span class="metric-label">Users</span>
                    </div>
                    <i class="fas fa-chevron-right metric-arrow"></i>
                </div>
                <div class="metric-card clickable" onclick="switchSection('products')">
                    <div class="metric-icon teal"><i class="fas fa-boxes"></i></div>
                    <div class="metric-info">
                        <span class="metric-value" id="metricProducts">0</span>
                        <span class="metric-label">Products</span>
                    </div>
                    <i class="fas fa-chevron-right metric-arrow"></i>
                </div>
                <div class="metric-card clickable" onclick="switchSection('analytics')">
                    <div class="metric-icon pink"><i class="fas fa-store"></i></div>
                    <div class="metric-info">
                        <span class="metric-value" id="metricStoreValue">KES 0</span>
                        <span class="metric-label">Store Value</span>
                    </div>
                    <i class="fas fa-chevron-right metric-arrow"></i>
                </div>
            </div>

            <!-- Sales Statistics Card -->
            <div class="sales-stats-card clickable" onclick="switchSection('analytics')" style="cursor: pointer;">
                <div class="sales-stats-header">
                    <h3><i class="fas fa-chart-line"></i> Sales Statistics</h3>
                    <i class="fas fa-chevron-right metric-arrow"></i>
                </div>
                <div class="sales-grid">
                    <div class="sales-stat">
                        <span class="sales-value" id="totalSalesCount">0</span>
                        <span class="sales-label">Total Sales</span>
                    </div>
                    <div class="sales-stat">
                        <span class="sales-value" id="totalRevenueAmount">KES 0</span>
                        <span class="sales-label">Total Revenue</span>
                    </div>
                    <div class="sales-stat">
                        <span class="sales-value" id="monthSalesCount">0</span>
                        <span class="sales-label">This Month Sales</span>
                    </div>
                    <div class="sales-stat">
                        <span class="sales-value" id="monthRevenueAmount">KES 0</span>
                        <span class="sales-label">This Month Revenue</span>
                    </div>
                </div>
            </div>

            <!-- Quick Actions for Solo Manager -->
            <div class="card" style="margin-bottom:16px;">
                <div class="card-header">
                    <h3><i class="fas fa-bolt" style="color:#f59e0b;"></i> Quick Actions</h3>
                </div>
                <div class="card-body" style="padding:12px;">
                    <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(120px,1fr));gap:10px;">
                        <button class="btn btn-outline" onclick="switchSection('orders')" style="display:flex;flex-direction:column;align-items:center;gap:6px;padding:14px 8px;font-size:12px;">
                            <i class="fas fa-shopping-bag" style="font-size:20px;color:#3b82f6;"></i>
                            Manage Orders
                        </button>
                        <button class="btn btn-outline" onclick="switchSection('products')" style="display:flex;flex-direction:column;align-items:center;gap:6px;padding:14px 8px;font-size:12px;">
                            <i class="fas fa-box" style="font-size:20px;color:#10b981;"></i>
                            Products
                        </button>
                        <button class="btn btn-outline" onclick="switchSection('notifications')" style="display:flex;flex-direction:column;align-items:center;gap:6px;padding:14px 8px;font-size:12px;">
                            <i class="fas fa-bullhorn" style="font-size:20px;color:#f97316;"></i>
                            Send Notification
                        </button>
                        <button class="btn btn-outline" onclick="switchSection('settings')" style="display:flex;flex-direction:column;align-items:center;gap:6px;padding:14px 8px;font-size:12px;">
                            <i class="fas fa-images" style="font-size:20px;color:#8b5cf6;"></i>
                            Hero Slides
                        </button>
                        <button class="btn btn-outline" onclick="switchSection('verifications')" style="display:flex;flex-direction:column;align-items:center;gap:6px;padding:14px 8px;font-size:12px;">
                            <i class="fas fa-shield-alt" style="font-size:20px;color:#ef4444;"></i>
                            Verifications
                        </button>
                        <button class="btn btn-outline" onclick="switchSection('settings')" style="display:flex;flex-direction:column;align-items:center;gap:6px;padding:14px 8px;font-size:12px;">
                            <i class="fas fa-map-marked-alt" style="font-size:20px;color:#06b6d4;"></i>
                            Delivery Areas
                        </button>
                        <a href="delivery.html" class="btn btn-outline" style="display:flex;flex-direction:column;align-items:center;gap:6px;padding:14px 8px;font-size:12px;text-decoration:none;color:inherit;">
                            <i class="fas fa-truck" style="font-size:20px;color:#16a34a;"></i>
                            Delivery Board
                        </a>
                    </div>
                </div>
            </div>

            <div class="dashboard-grid">
                <div class="card">
                    <div class="card-header">
                        <h3>Recent Orders</h3>
                        <a href="#" class="view-all" data-section="orders">View All</a>
                    </div>
                    <div class="card-body" id="recentOrders">
                        <div class="loading-spinner"></div>
                    </div>
                </div>
                <div class="card">
                    <div class="card-header">
                        <h3>Order Status</h3>
                    </div>
                    <div class="card-body chart-container">
                        <canvas id="statusChart"></canvas>
                    </div>
                </div>
                <div class="card">
                    <div class="card-header">
                        <h3>Weekly Sales</h3>
                    </div>
                    <div class="card-body chart-container">
                        <canvas id="salesChart"></canvas>
                    </div>
                </div>
                <div class="card">
                    <div class="card-header">
                        <h3>Top Categories</h3>
                    </div>
                    <div class="card-body chart-container">
                        <canvas id="categoryChart"></canvas>
                    </div>
                </div>
            </div>
        </section>

        <!-- Orders -->
        <section class="page" id="orders-page">
            <div class="page-header">
                <h2>Orders</h2>
                <div class="header-controls">
                    <select id="orderFilter" class="filter-select">
                        <option value="all">All Orders</option>
                        <option value="pending">Pending</option>
                        <option value="confirmed">Confirmed</option>
                        <option value="out_for_delivery">Delivering</option>
                        <option value="delivered">Delivered</option>
                        <option value="cancelled">Cancelled</option>
                    </select>
                    <div class="search-input">
                        <i class="fas fa-search"></i>
                        <input type="text" id="orderSearch" placeholder="Search orders...">
                    </div>
                </div>
            </div>
            <div class="table-wrapper">
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Order ID</th>
                            <th>Customer</th>
                            <th class="hide-sm">Items</th>
                            <th>Total</th>
                            <th>Status</th>
                            <th class="hide-sm">Date</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="ordersTable"></tbody>
                </table>
            </div>
            <div class="pagination" id="ordersPagination"></div>
        </section>

        <!-- Products -->
        <section class="page" id="products-page">
            <div class="page-header">
                <h2>Products</h2>
                <div class="header-controls">
                    <button class="btn btn-primary" id="addProductBtn">
                        <i class="fas fa-plus"></i> Add Product
                    </button>
                    <button class="btn btn-outline" id="exportBtn">
                        <i class="fas fa-download"></i> Export
                    </button>
                    <div class="search-input">
                        <i class="fas fa-search"></i>
                        <input type="text" id="productSearch" placeholder="Search products...">
                    </div>
                </div>
            </div>
            <div class="table-wrapper excel-table">
                <table class="data-table" id="productsTable">
                    <thead>
                        <tr>
                            <th style="width:60px;">Image</th>
                            <th style="min-width:150px;">Name</th>
                            <th style="min-width:100px;">Category</th>
                            <th style="width:100px;">Price (KES)</th>
                            <th style="width:80px;">Stock</th>
                            <th style="min-width:120px;">Brand</th>
                            <th style="width:140px;">Prime Tags</th>
                            <th style="width:100px;">Status</th>
                            <th style="width:100px;">Actions</th>
                        </tr>
                    </thead>
                    <tbody id="productsTableBody">
                        <tr><td colspan="9" class="loading-spinner"></td></tr>
                    </tbody>
                </table>
            </div>
            <div class="load-more-container">
                <button class="btn btn-primary" id="loadMoreProducts" style="display:none;">
                    Load More Products
                </button>
            </div>
        </section>

        <!-- Users -->
        <section class="page" id="users-page">
            <div class="page-header">
                <h2 id="usersPageTitle">Users</h2>
                <div class="header-controls">
                    <button class="btn btn-outline" id="backToUsersBtn" style="display:none;">
                        <i class="fas fa-arrow-left"></i> Back
                    </button>
                    <div class="search-input">
                        <i class="fas fa-search"></i>
                        <input type="text" id="userSearch" placeholder="Search users...">
                    </div>
                </div>
            </div>
            <!-- User Listings View -->
            <div id="userListingsView" style="display:none;">
                <div class="user-banner">
                    <img id="userBannerAvatar" src="images/profile-placeholder.png" class="user-banner-avatar">
                    <div class="user-banner-info">
                        <h3 id="userBannerName">User Name</h3>
                        <p id="userBannerEmail">email@example.com</p>
                        <div class="user-banner-stats">
                            <span><i class="fas fa-box"></i> <b id="userListingCount">0</b> Listings</span>
                            <span><i class="fas fa-shopping-cart"></i> <b id="userSalesCount">0</b> Sales</span>
                            <span><i class="fas fa-coins"></i> KES <b id="userRevenue">0</b></span>
                        </div>
                    </div>
                </div>
                <div class="table-wrapper excel-table">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th style="width:60px;">Image</th>
                                <th>Name</th>
                                <th>Category</th>
                                <th>Price</th>
                                <th>Stock</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="userProductsGrid"></tbody>
                    </table>
                </div>
            </div>
            <!-- Users Table -->
            <div id="usersTableView">
                <div class="table-wrapper">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>User</th>
                                <th class="hide-sm">Email</th>
                                <th>Listings</th>
                                <th class="hide-sm">Verified</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="usersTable"></tbody>
                    </table>
                </div>
            </div>
        </section>

        <!-- Analytics -->
        <section class="page" id="analytics-page">
            <div class="page-header">
                <h2>Analytics</h2>
                <div class="header-controls">
                    <select id="analyticsPeriod" class="filter-select">
                        <option value="7">Last 7 Days</option>
                        <option value="30" selected>Last 30 Days</option>
                        <option value="90">Last 90 Days</option>
                    </select>
                    <button class="btn btn-outline" id="exportReportBtn">
                        <i class="fas fa-file-export"></i> Export
                    </button>
                </div>
            </div>
            <div class="analytics-metrics">
                <div class="analytics-card">
                    <span class="analytics-icon green"><i class="fas fa-chart-line"></i></span>
                    <div>
                        <span class="analytics-value" id="aSales">KES 0</span>
                        <span class="analytics-label">Total Sales</span>
                    </div>
                    <span class="analytics-change positive" id="aSalesChange">+0%</span>
                </div>
                <div class="analytics-card">
                    <span class="analytics-icon blue"><i class="fas fa-receipt"></i></span>
                    <div>
                        <span class="analytics-value" id="aOrders">0</span>
                        <span class="analytics-label">Orders</span>
                    </div>
                    <span class="analytics-change positive" id="aOrdersChange">+0%</span>
                </div>
                <div class="analytics-card">
                    <span class="analytics-icon orange"><i class="fas fa-tags"></i></span>
                    <div>
                        <span class="analytics-value" id="aAvgOrder">KES 0</span>
                        <span class="analytics-label">Avg. Order</span>
                    </div>
                    <span class="analytics-change" id="aAvgChange">0%</span>
                </div>
                <div class="analytics-card">
                    <span class="analytics-icon purple"><i class="fas fa-user-plus"></i></span>
                    <div>
                        <span class="analytics-value" id="aNewUsers">0</span>
                        <span class="analytics-label">New Users</span>
                    </div>
                    <span class="analytics-change positive" id="aUsersChange">+0%</span>
                </div>
            </div>
            <div class="analytics-grid">
                <div class="card wide">
                    <div class="card-header"><h3>Revenue Trend</h3></div>
                    <div class="card-body chart-container-lg">
                        <canvas id="revenueChart"></canvas>
                    </div>
                </div>
                <div class="card">
                    <div class="card-header"><h3>Top Sellers</h3></div>
                    <div class="card-body" id="topSellers">
                        <div class="loading-spinner"></div>
                    </div>
                </div>
                <div class="card">
                    <div class="card-header"><h3>Best Products</h3></div>
                    <div class="card-body" id="bestProducts">
                        <div class="loading-spinner"></div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Transactions -->
        <section class="page" id="transactions-page">
            <div class="page-header">
                <h2>Transactions</h2>
                <div class="header-controls">
                    <div class="search-input">
                        <i class="fas fa-search"></i>
                        <input type="text" id="transactionSearch" placeholder="Search by ID, user, M-Pesa code...">
                    </div>
                    <select id="transactionFilter" class="filter-select">
                        <option value="all">All Transactions</option>
                        <option value="completed">Completed</option>
                        <option value="pending">Pending</option>
                        <option value="failed">Failed</option>
                    </select>
                </div>
            </div>
            <div class="table-wrapper">
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Transaction ID</th>
                            <th class="hide-sm">User</th>
                            <th>Amount</th>
                            <th class="hide-sm">Method</th>
                            <th>Status</th>
                            <th>Date & Time</th>
                            <th>Action</th>
                        </tr>
                    </thead>
                    <tbody id="transactionsTable"></tbody>
                </table>
            </div>
        </section>

        <!-- Verifications -->
        <section class="page" id="verifications-page">
            <div class="page-header">
                <h2>Payment Verifications</h2>
                <div class="header-controls">
                    <select id="verificationFilter" class="filter-select">
                        <option value="pending">Pending</option>
                        <option value="all">All</option>
                        <option value="approved">Approved</option>
                        <option value="rejected">Rejected</option>
                    </select>
                    <button class="btn btn-outline" id="refreshVerificationsBtn">
                        <i class="fas fa-sync-alt"></i> Refresh
                    </button>
                </div>
            </div>
            <div class="verifications-list" id="verificationsList">
                <div class="loading-spinner"></div>
            </div>
        </section>

        <!-- Push Notifications Management -->
        <section class="page" id="notifications-page">
            <div class="page-header">
                <h2>Push Notifications</h2>
            </div>
            
            <!-- Notification Stats -->
            <div class="notification-stats">
                <div class="notif-stat-card">
                    <div class="notif-stat-icon blue"><i class="fas fa-users"></i></div>
                    <div class="notif-stat-info">
                        <span class="notif-stat-value" id="totalSubscribers">0</span>
                        <span class="notif-stat-label">Subscribers</span>
                    </div>
                </div>
                <div class="notif-stat-card">
                    <div class="notif-stat-icon green"><i class="fas fa-paper-plane"></i></div>
                    <div class="notif-stat-info">
                        <span class="notif-stat-value" id="notifsSent">0</span>
                        <span class="notif-stat-label">Sent Today</span>
                    </div>
                </div>
                <div class="notif-stat-card">
                    <div class="notif-stat-icon orange"><i class="fas fa-mobile-alt"></i></div>
                    <div class="notif-stat-info">
                        <span class="notif-stat-value" id="mobileSubscribers">0</span>
                        <span class="notif-stat-label">Mobile Users</span>
                    </div>
                </div>
            </div>

            <!-- Send Notification Form -->
            <div class="card">
                <div class="card-header">
                    <h3><i class="fas fa-broadcast-tower"></i> Send Push Notification</h3>
                </div>
                <div class="card-body">
                    <form id="pushNotificationForm">
                        <div class="form-group">
                            <label for="notifTitle"><i class="fas fa-heading"></i> Title *</label>
                            <input type="text" id="notifTitle" placeholder="Notification title" required maxlength="65">
                            <small class="char-count"><span id="titleCount">0</span>/65</small>
                        </div>
                        
                        <div class="form-group">
                            <label for="notifBody"><i class="fas fa-comment"></i> Message *</label>
                            <textarea id="notifBody" placeholder="Notification message" required maxlength="240" rows="3"></textarea>
                            <small class="char-count"><span id="bodyCount">0</span>/240</small>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group half">
                                <label for="notifUrl"><i class="fas fa-link"></i> Action URL (optional)</label>
                                <input type="text" id="notifUrl" placeholder="/notification.html">
                            </div>
                            <div class="form-group half">
                                <label for="notifTarget"><i class="fas fa-bullseye"></i> Target Audience</label>
                                <select id="notifTarget">
                                    <option value="all">All Users</option>
                                    <option value="buyers">Buyers Only</option>
                                    <option value="sellers">Sellers Only</option>
                                </select>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="notifType"><i class="fas fa-tag"></i> Notification Type</label>
                            <select id="notifType">
                                <option value="general">General Announcement</option>
                                <option value="promo">Promotion / Sale</option>
                                <option value="update">App Update</option>
                                <option value="alert">Important Alert</option>
                            </select>
                        </div>

                        <div class="form-actions">
                            <button type="button" class="btn btn-outline" id="previewNotifBtn">
                                <i class="fas fa-eye"></i> Preview
                            </button>
                            <button type="submit" class="btn btn-primary" id="sendNotifBtn">
                                <i class="fas fa-paper-plane"></i> Send to All
                            </button>
                        </div>
                    </form>
                </div>
            </div>

            <!-- Notification Preview Modal -->
            <div class="notif-preview-modal" id="notifPreviewModal">
                <div class="notif-preview-overlay"></div>
                <div class="notif-preview-content">
                    <div class="notif-preview-phone">
                        <div class="notif-preview-header">
                            <span class="notif-preview-time">Now</span>
                        </div>
                        <div class="notif-preview-card">
                            <img src="favicon_io/android-chrome-192x192.png" class="notif-preview-icon">
                            <div class="notif-preview-text">
                                <strong id="previewTitle">Notification Title</strong>
                                <p id="previewBody">Notification message will appear here</p>
                            </div>
                        </div>
                    </div>
                    <button class="btn btn-primary" onclick="document.getElementById('notifPreviewModal').classList.remove('show')">Close</button>
                </div>
            </div>

            <!-- Recent Notifications History -->
            <div class="card">
                <div class="card-header">
                    <h3><i class="fas fa-history"></i> Recent Notifications</h3>
                    <button class="btn btn-outline btn-sm" id="refreshNotifsBtn">
                        <i class="fas fa-sync-alt"></i>
                    </button>
                </div>
                <div class="card-body">
                    <div class="notif-history-list" id="notifHistoryList">
                        <div class="loading-spinner"></div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Settings -->
        <section class="page" id="settings-page">
            <div class="page-header">
                <h2>Settings</h2>
            </div>
            <div class="settings-grid">
                <!-- Delivery Areas Management -->
                <div class="card full-width">
                    <div class="card-header">
                        <h3><i class="fas fa-map-marked-alt"></i> Delivery Areas</h3>
                        <button class="btn btn-primary btn-sm" id="saveDeliveryAreasBtn"><i class="fas fa-save"></i> Save Changes</button>
                    </div>
                    <div class="card-body">
                        <p class="settings-hint">Enable or disable delivery to specific counties. Currently serving Mombasa. Enable more areas to expand operations.</p>
                        
                        <div class="delivery-areas-config">
                            <div class="area-status-banner" id="areaStatusBanner">
                                <i class="fas fa-info-circle"></i>
                                <span>Active delivery areas: <strong id="activeAreasCount">1</strong></span>
                            </div>
                            
                            <div class="region-section">
                                <h4><i class="fas fa-water"></i> Coast Region</h4>
                                <div class="county-toggles" id="coastCounties">
                                    <label class="county-toggle">
                                        <input type="checkbox" data-county="Mombasa" data-region="coast" checked>
                                        <span class="county-name">Mombasa</span>
                                        <span class="county-badge active">Active</span>
                                    </label>
                                    <label class="county-toggle">
                                        <input type="checkbox" data-county="Kwale" data-region="coast">
                                        <span class="county-name">Kwale</span>
                                        <span class="county-badge">Inactive</span>
                                    </label>
                                    <label class="county-toggle">
                                        <input type="checkbox" data-county="Kilifi" data-region="coast">
                                        <span class="county-name">Kilifi</span>
                                        <span class="county-badge">Inactive</span>
                                    </label>
                                    <label class="county-toggle">
                                        <input type="checkbox" data-county="Tana River" data-region="coast">
                                        <span class="county-name">Tana River</span>
                                        <span class="county-badge">Inactive</span>
                                    </label>
                                    <label class="county-toggle">
                                        <input type="checkbox" data-county="Lamu" data-region="coast">
                                        <span class="county-name">Lamu</span>
                                        <span class="county-badge">Inactive</span>
                                    </label>
                                    <label class="county-toggle">
                                        <input type="checkbox" data-county="Taita-Taveta" data-region="coast">
                                        <span class="county-name">Taita-Taveta</span>
                                        <span class="county-badge">Inactive</span>
                                    </label>
                                </div>
                            </div>
                            
                            <div class="region-section">
                                <h4><i class="fas fa-city"></i> Nairobi Region</h4>
                                <div class="county-toggles" id="nairobiCounties">
                                    <label class="county-toggle">
                                        <input type="checkbox" data-county="Nairobi" data-region="nairobi">
                                        <span class="county-name">Nairobi</span>
                                        <span class="county-badge">Inactive</span>
                                    </label>
                                </div>
                            </div>
                            
                            <div class="region-section">
                                <h4><i class="fas fa-mountain"></i> Central Region</h4>
                                <div class="county-toggles" id="centralCounties">
                                    <label class="county-toggle">
                                        <input type="checkbox" data-county="Kiambu" data-region="central">
                                        <span class="county-name">Kiambu</span>
                                        <span class="county-badge">Inactive</span>
                                    </label>
                                    <label class="county-toggle">
                                        <input type="checkbox" data-county="Muranga" data-region="central">
                                        <span class="county-name">Muranga</span>
                                        <span class="county-badge">Inactive</span>
                                    </label>
                                    <label class="county-toggle">
                                        <input type="checkbox" data-county="Nyeri" data-region="central">
                                        <span class="county-name">Nyeri</span>
                                        <span class="county-badge">Inactive</span>
                                    </label>
                                    <label class="county-toggle">
                                        <input type="checkbox" data-county="Kirinyaga" data-region="central">
                                        <span class="county-name">Kirinyaga</span>
                                        <span class="county-badge">Inactive</span>
                                    </label>
                                    <label class="county-toggle">
                                        <input type="checkbox" data-county="Nyandarua" data-region="central">
                                        <span class="county-name">Nyandarua</span>
                                        <span class="county-badge">Inactive</span>
                                    </label>
                                </div>
                            </div>
                            
                            <div class="region-section collapsed" id="moreRegions">
                                <button class="btn btn-outline btn-sm expand-regions-btn" id="expandRegionsBtn">
                                    <i class="fas fa-chevron-down"></i> Show More Regions
                                </button>
                                
                                <div class="hidden-regions" style="display: none;">
                                    <h4><i class="fas fa-sun"></i> Eastern Region</h4>
                                    <div class="county-toggles">
                                        <label class="county-toggle">
                                            <input type="checkbox" data-county="Machakos" data-region="eastern">
                                            <span class="county-name">Machakos</span>
                                            <span class="county-badge">Inactive</span>
                                        </label>
                                        <label class="county-toggle">
                                            <input type="checkbox" data-county="Makueni" data-region="eastern">
                                            <span class="county-name">Makueni</span>
                                            <span class="county-badge">Inactive</span>
                                        </label>
                                        <label class="county-toggle">
                                            <input type="checkbox" data-county="Kitui" data-region="eastern">
                                            <span class="county-name">Kitui</span>
                                            <span class="county-badge">Inactive</span>
                                        </label>
                                        <label class="county-toggle">
                                            <input type="checkbox" data-county="Embu" data-region="eastern">
                                            <span class="county-name">Embu</span>
                                            <span class="county-badge">Inactive</span>
                                        </label>
                                        <label class="county-toggle">
                                            <input type="checkbox" data-county="Meru" data-region="eastern">
                                            <span class="county-name">Meru</span>
                                            <span class="county-badge">Inactive</span>
                                        </label>
                                    </div>
                                    
                                    <h4><i class="fas fa-tree"></i> Rift Valley Region</h4>
                                    <div class="county-toggles">
                                        <label class="county-toggle">
                                            <input type="checkbox" data-county="Nakuru" data-region="rift-valley">
                                            <span class="county-name">Nakuru</span>
                                            <span class="county-badge">Inactive</span>
                                        </label>
                                        <label class="county-toggle">
                                            <input type="checkbox" data-county="Kajiado" data-region="rift-valley">
                                            <span class="county-name">Kajiado</span>
                                            <span class="county-badge">Inactive</span>
                                        </label>
                                        <label class="county-toggle">
                                            <input type="checkbox" data-county="Narok" data-region="rift-valley">
                                            <span class="county-name">Narok</span>
                                            <span class="county-badge">Inactive</span>
                                        </label>
                                        <label class="county-toggle">
                                            <input type="checkbox" data-county="Uasin Gishu" data-region="rift-valley">
                                            <span class="county-name">Uasin Gishu (Eldoret)</span>
                                            <span class="county-badge">Inactive</span>
                                        </label>
                                        <label class="county-toggle">
                                            <input type="checkbox" data-county="Kericho" data-region="rift-valley">
                                            <span class="county-name">Kericho</span>
                                            <span class="county-badge">Inactive</span>
                                        </label>
                                    </div>
                                    
                                    <h4><i class="fas fa-fish"></i> Nyanza Region</h4>
                                    <div class="county-toggles">
                                        <label class="county-toggle">
                                            <input type="checkbox" data-county="Kisumu" data-region="nyanza">
                                            <span class="county-name">Kisumu</span>
                                            <span class="county-badge">Inactive</span>
                                        </label>
                                        <label class="county-toggle">
                                            <input type="checkbox" data-county="Migori" data-region="nyanza">
                                            <span class="county-name">Migori</span>
                                            <span class="county-badge">Inactive</span>
                                        </label>
                                        <label class="county-toggle">
                                            <input type="checkbox" data-county="Kisii" data-region="nyanza">
                                            <span class="county-name">Kisii</span>
                                            <span class="county-badge">Inactive</span>
                                        </label>
                                    </div>
                                    
                                    <h4><i class="fas fa-wheat-alt"></i> Western Region</h4>
                                    <div class="county-toggles">
                                        <label class="county-toggle">
                                            <input type="checkbox" data-county="Kakamega" data-region="western">
                                            <span class="county-name">Kakamega</span>
                                            <span class="county-badge">Inactive</span>
                                        </label>
                                        <label class="county-toggle">
                                            <input type="checkbox" data-county="Bungoma" data-region="western">
                                            <span class="county-name">Bungoma</span>
                                            <span class="county-badge">Inactive</span>
                                        </label>
                                        <label class="county-toggle">
                                            <input type="checkbox" data-county="Busia" data-region="western">
                                            <span class="county-name">Busia</span>
                                            <span class="county-badge">Inactive</span>
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Shipping Fee Settings -->
                <div class="card full-width">
                    <div class="card-header">
                        <h3><i class="fas fa-shipping-fast"></i> Shipping Fee Settings</h3>
                        <button class="btn btn-primary btn-sm" id="saveShippingBtn"><i class="fas fa-save"></i> Save Changes</button>
                    </div>
                    <div class="card-body">
                        <p class="settings-hint">Configure shipping fees for different Mombasa locations. Default fee applies when no location matches.</p>
                        
                        <div class="shipping-config">
                            <div class="form-group">
                                <label>Default Shipping Fee (KES)</label>
                                <input type="number" id="defaultShippingFee" min="0" placeholder="150" value="150">
                            </div>
                            
                            <div class="form-group">
                                <label>Free Shipping Threshold (KES) <small>(Orders above this amount get free delivery. 0 = disabled)</small></label>
                                <input type="number" id="freeShippingThreshold" min="0" placeholder="3000" value="3000">
                            </div>
                        </div>
                        
                        <h4 style="margin: 20px 0 15px; font-size: 14px; color: #666;">
                            <i class="fas fa-map-marker-alt"></i> Location-Based Shipping Fees
                        </h4>
                        
                        <div class="shipping-zones" id="shippingZonesList">
                            <div class="loading-spinner"></div>
                        </div>
                        
                        <button class="btn btn-outline btn-sm" id="addShippingZoneBtn" style="margin-top: 15px;">
                            <i class="fas fa-plus"></i> Add Shipping Zone
                        </button>
                    </div>
                </div>

                <!-- Delivery Staff Management -->
                <div class="card full-width">
                    <div class="card-header">
                        <h3><i class="fas fa-truck"></i> Delivery Staff</h3>
                    </div>
                    <div class="card-body">
                        <p class="settings-hint">Add user accounts that can access the <a href="delivery.html" target="_blank">Delivery Dashboard</a> to manage order pickups and deliveries.</p>
                        <div style="display:flex;gap:8px;margin-bottom:16px;">
                            <input type="email" id="deliveryStaffEmail" placeholder="Enter user email" style="flex:1;padding:8px 12px;border:1px solid #d1d5db;border-radius:8px;font-size:13px;">
                            <button class="btn btn-primary btn-sm" id="addDeliveryStaffBtn"><i class="fas fa-plus"></i> Add</button>
                        </div>
                        <div id="deliveryStaffList" style="display:flex;flex-direction:column;gap:8px;">
                            <div class="loading-spinner"></div>
                        </div>
                    </div>
                </div>

                <!-- Hero Banner Management -->
                <div class="card full-width">
                    <div class="card-header">
                        <h3><i class="fas fa-images"></i> Hero Banner Slides</h3>
                        <button class="btn btn-primary btn-sm" id="addSlideBtn"><i class="fas fa-plus"></i> Add Slide</button>
                    </div>
                    <div class="card-body">
                        <p class="settings-hint">Manage the carousel slides shown on the homepage. Drag to reorder.</p>
                        <div class="hero-slides-list" id="heroSlidesList">
                            <div class="loading-spinner"></div>
                        </div>
                    </div>
                </div>
                
                <div class="card">
                    <div class="card-header">
                        <h3><i class="fas fa-user-shield"></i> Admin Management</h3>
                    </div>
                    <div class="card-body">
                        <div class="input-group">
                            <input type="email" id="newAdminEmail" placeholder="Enter admin email">
                            <button class="btn btn-primary" id="addAdminBtn">Add Admin</button>
                        </div>
                        <div class="admin-list" id="adminList"></div>
                    </div>
                </div>
                <div class="card">
                    <div class="card-header">
                        <h3><i class="fas fa-sliders-h"></i> System Settings</h3>
                    </div>
                    <div class="card-body">
                        <label class="toggle-item">
                            <span>Maintenance Mode</span>
                            <input type="checkbox" id="maintenanceMode">
                        </label>
                        <label class="toggle-item">
                            <span>Allow Registrations</span>
                            <input type="checkbox" id="allowRegistrations" checked>
                        </label>
                    </div>
                </div>
                
                <!-- User Survey Settings -->
                <div class="card">
                    <div class="card-header">
                        <h3><i class="fas fa-poll"></i> User Survey Settings</h3>
                    </div>
                    <div class="card-body">
                        <p class="settings-hint">Enable quick surveys during signup to collect user preferences (age, gender, shopping interests).</p>
                        <label class="toggle-item">
                            <span>Enable Signup Survey</span>
                            <input type="checkbox" id="surveyEnabled">
                        </label>
                        <div class="survey-stats" id="surveyStats" style="margin-top: 15px; padding-top: 15px; border-top: 1px solid #eee;">
                            <div class="loading-spinner"></div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- Order Detail Modal -->
    <div class="modal" id="orderModal">
        <div class="modal-content">
            <button class="modal-close" id="closeModal">&times;</button>
            <div id="orderModalContent"></div>
        </div>
    </div>

    <!-- Product Edit Modal -->
    <div class="modal" id="productModal">
        <div class="modal-content" style="max-width:600px;">
            <button class="modal-close" id="closeProductModal">&times;</button>
            <h3 id="productModalTitle" style="margin-bottom:20px;">Edit Product</h3>
            <form id="productForm">
                <input type="hidden" id="editProductId">
                
                <!-- Image Management -->
                <div class="form-group">
                    <label>Product Images</label>
                    <div class="image-manager" id="imageManager">
                        <div class="image-list" id="imageList"></div>
                        <label class="image-add-btn" id="imageAddBtn">
                            <i class="fas fa-plus"></i>
                            <span>Add Image</span>
                            <input type="file" id="imageInput" accept="image/*" multiple hidden>
                        </label>
                    </div>
                    <p class="form-hint">Click image to remove. Max 5 images.</p>
                </div>
                
                <div class="form-group">
                    <label>Product Name</label>
                    <input type="text" id="editName" required placeholder="Product name">
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Category</label>
                        <input type="text" id="editCategory" placeholder="Category">
                    </div>
                    <div class="form-group">
                        <label>Brand</label>
                        <input type="text" id="editBrand" placeholder="Brand">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Price (KES)</label>
                        <input type="number" id="editPrice" required min="0" placeholder="0">
                    </div>
                    <div class="form-group">
                        <label>Stock</label>
                        <input type="number" id="editStock" required min="0" placeholder="0">
                    </div>
                </div>
                <div class="form-group">
                    <label>Description</label>
                    <textarea id="editDescription" rows="3" placeholder="Product description"></textarea>
                </div>
                <div class="form-group">
                    <label>Status</label>
                    <select id="editStatus">
                        <option value="active">Active</option>
                        <option value="inactive">Inactive</option>
                        <option value="out_of_stock">Out of Stock</option>
                    </select>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn-outline" onclick="closeProductModal()">Cancel</button>
                    <button type="submit" class="btn btn-primary" id="saveProductBtn">Save Changes</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Hero Slide Modal -->
    <div class="modal" id="slideModal">
        <div class="modal-content" style="max-width:500px;">
            <button class="modal-close" id="closeSlideModal">&times;</button>
            <h3 id="slideModalTitle">Add Hero Slide</h3>
            <form id="slideForm">
                <input type="hidden" id="editSlideId">
                <div class="form-group">
                    <label>Slide Title</label>
                    <input type="text" id="slideTitle" required placeholder="e.g. Big Sale Today!">
                </div>
                <div class="form-group">
                    <label>Subtitle/Description</label>
                    <input type="text" id="slideSubtitle" placeholder="e.g. Up to 50% off">
                </div>
                <div class="form-group">
                    <label>Button Text (optional)</label>
                    <input type="text" id="slideBtnText" placeholder="e.g. Shop Now">
                </div>
                <div class="form-group">
                    <label>Button Link (optional)</label>
                    <input type="text" id="slideBtnLink" placeholder="e.g. category.html?category=fashion">
                </div>
                <div class="form-group">
                    <label>Background Image (optional)</label>
                    <div class="slide-image-upload">
                        <input type="file" id="slideBgImage" accept="image/*">
                        <div class="slide-image-preview" id="slideImagePreview"></div>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Gradient Style</label>
                        <select id="slideGradient">
                            <option value="gradient-1">Orange (Primary)</option>
                            <option value="gradient-2">Gold (Featured)</option>
                            <option value="gradient-3">Blue (Cool)</option>
                            <option value="gradient-4">Green (Fresh)</option>
                            <option value="gradient-5">Purple (Premium)</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Icon</label>
                        <select id="slideIcon">
                            <option value="fa-store">Store</option>
                            <option value="fa-star">Star</option>
                            <option value="fa-rocket">Rocket</option>
                            <option value="fa-fire">Fire</option>
                            <option value="fa-percent">Percent</option>
                            <option value="fa-gift">Gift</option>
                            <option value="fa-bolt">Bolt</option>
                            <option value="fa-crown">Crown</option>
                        </select>
                    </div>
                </div>
                <div class="form-group">
                    <label class="toggle-item">
                        <span>Active</span>
                        <input type="checkbox" id="slideActive" checked>
                    </label>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn-outline" onclick="closeSlideModal()">Cancel</button>
                    <button type="submit" class="btn btn-primary">Save Slide</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Status Change Modal -->
    <div class="modal" id="statusModal">
        <div class="modal-content" style="max-width:400px;">
            <div class="modal-header">
                <h3><i class="fas fa-exchange-alt"></i> Change Order Status</h3>
                <button class="close-btn" onclick="closeStatusModal()">&times;</button>
            </div>
            <div style="padding:20px;">
                <p style="margin-bottom:12px;color:var(--gray-600);font-size:14px;">Select new status for this order:</p>
                <select id="statusSelect" style="width:100%;padding:10px 12px;border:1px solid var(--gray-200);border-radius:var(--radius);font-size:14px;margin-bottom:16px;"></select>
                <div style="display:flex;gap:10px;justify-content:flex-end;">
                    <button class="btn btn-outline" onclick="closeStatusModal()">Cancel</button>
                    <button class="btn btn-primary" id="confirmStatusBtn" onclick="confirmStatusChange()">Update Status</button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <script type="module" src="admin.js"></script>
</body>
</html>
